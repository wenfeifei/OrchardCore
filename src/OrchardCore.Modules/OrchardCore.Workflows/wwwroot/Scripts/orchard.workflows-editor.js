/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

///<reference path='../Lib/jquery/typings.d.ts' />
var applyFilter = function applyFilter(category, q) {
  var type = $('.modal-activities').data('activity-type');
  category = category || $('.activity-picker-categories .nav-link.active').attr('href').substr(1);
  q = q || $('.modal-activities input[type=search]').val();
  var $cards = $('.activity.card').show(); // Remove activities whoes type doesn't match the configured activity type.

  $cards.filter(function (i, el) {
    return $(el).data('activity-type') != type;
  }).hide();

  if (q.length > 0) {
    // Remove activities whose title doesn't match the query.
    $cards.filter(function (i, el) {
      return $(el).find('.card-title').text().toLowerCase().indexOf(q.toLowerCase()) < 0 && q && q.length > 0;
    }).hide();
  } else {
    // Remove activities whose category doesn't match the selected one.
    $cards.filter(function (i, el) {
      return $(el).data('category').toLowerCase() != category.toLowerCase() && category.toLowerCase() != 'all';
    }).hide();
  } // Show or hide categories based on whether there are any available activities.


  $('.activity-picker-categories [data-category]').each(function (i, el) {
    var categoryListItem = $(el);
    var category = categoryListItem.data('category'); // Count number of activities within this category and for the specified activity type (Event or Task).

    var activityCount = $(".activity.card[data-category='" + category + "'][data-activity-type='" + type + "']").length;
    activityCount == 0 ? categoryListItem.hide() : categoryListItem.show();
  });
};

$(function () {
  $('.activity-picker-categories').on('click', '.nav-link', function (e) {
    applyFilter($(e.target).attr('href').substr(1), null);
  });
  $('.modal-activities input[type=search]').on('keyup', function (e) {
    applyFilter(null, $(e.target).val());
  });
  $('#activity-picker').on('show.bs.modal', function (event) {
    var modalEvent = event;
    var button = $(modalEvent.relatedTarget); // Button that triggered the modal.

    var title = button.data('picker-title');
    var type = button.data('activity-type');
    var modal = $(this);
    modal.find('[href="#all"]').click();
    modal.find('.modal-title').text(title);
    modal.data('activity-type', type);
    applyFilter(null, null);
  });
});
///<reference path="../../../Assets/Lib/jquery/typings.d.ts" />
$(function () {
  var generateWorkflowUrl = function generateWorkflowUrl() {
    var workflowTypeId = $('[data-workflow-type-id]').data('workflow-type-id');
    var activityId = $('[data-activity-id]').data('activity-id');
    var tokenLifeSpan = $('#token-lifespan').val();
    var generateUrl = $('[data-generate-url]').data('generate-url') + ("?workflowTypeId=" + workflowTypeId + "&activityId=" + activityId + "&tokenLifeSpan=" + tokenLifeSpan);
    var antiforgeryHeaderName = $('[data-antiforgery-header-name]').data('antiforgery-header-name');
    var antiforgeryToken = $('[data-antiforgery-token]').data('antiforgery-token');
    var headers = {};
    headers[antiforgeryHeaderName] = antiforgeryToken;
    $.post({
      url: generateUrl,
      headers: headers
    }).done(function (url) {
      $('#workflow-url-text').val(url);
    });
  };

  $('#generate-url-button').on('click', function (e) {
    generateWorkflowUrl();
  });

  if ($('#workflow-url-text').val() == '') {
    generateWorkflowUrl();
  }
});
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
var WorkflowCanvas =
/** @class */
function () {
  function WorkflowCanvas(container, workflowType) {
    var _this = this;

    this.container = container;
    this.workflowType = workflowType;
    this.minCanvasHeight = 400;

    this.getActivityElements = function () {
      return $(_this.container).find('.activity');
    };

    this.getDefaults = function () {
      return {
        Anchor: "Continuous",
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        EndpointStyles: [{
          fillStyle: '#225588'
        }],
        Endpoints: [["Dot", {
          radius: 7
        }], ["Blank"]],
        ConnectionOverlays: [["Arrow", {
          width: 12,
          length: 12,
          location: -5
        }]],
        ConnectorZIndex: 5
      };
    };

    this.createJsPlumbInstance = function () {
      return jsPlumb.getInstance({
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        ConnectionOverlays: [['Arrow', {
          location: 1,
          visible: true,
          width: 11,
          length: 11
        }], ['Label', {
          location: 0.5,
          id: 'label',
          cssClass: 'connection-label'
        }]],
        Container: _this.container
      });
    };

    this.getEndpointColor = function (activity) {
      return activity.isBlocking || activity.isStart ? '#7ab02c' : activity.isEvent ? '#3a8acd' : '#7ab02c';
    };

    this.getSourceEndpointOptions = function (activity, outcome) {
      // The definition of source endpoints.
      var paintColor = _this.getEndpointColor(activity);

      return {
        endpoint: 'Dot',
        anchor: 'Continuous',
        paintStyle: {
          stroke: paintColor,
          fill: paintColor,
          radius: 7,
          strokeWidth: 1
        },
        isSource: true,
        connector: ['Flowchart', {
          stub: [40, 60],
          gap: 0,
          cornerRadius: 5,
          alwaysRespectStubs: true
        }],
        connectorStyle: {
          strokeWidth: 2,
          stroke: '#999999',
          joinstyle: 'round',
          outlineStroke: 'white',
          outlineWidth: 2
        },
        hoverPaintStyle: {
          fill: '#216477',
          stroke: '#216477'
        },
        connectorHoverStyle: {
          strokeWidth: 3,
          stroke: '#216477',
          outlineWidth: 5,
          outlineStroke: 'white'
        },
        connectorOverlays: [['Label', {
          location: [3, -1.5],
          cssClass: 'endpointSourceLabel'
        }]],
        dragOptions: {},
        uuid: activity.id + "-" + outcome.name,
        parameters: {
          outcome: outcome
        }
      };
    };

    this.getActivity = function (id, activities) {
      if (activities === void 0) {
        activities = null;
      }

      if (!activities) {
        activities = this.workflowType.activities;
      }

      return $.grep(activities, function (x) {
        return x.id === id;
      })[0];
    };

    this.updateConnections = function (plumber) {
      var workflowId = _this.workflowType.id; // Connect activities.

      for (var _i = 0, _a = _this.workflowType.transitions; _i < _a.length; _i++) {
        var transitionModel = _a[_i];
        var sourceEndpointUuid = transitionModel.sourceActivityId + "-" + transitionModel.sourceOutcomeName;
        var sourceEndpoint = plumber.getEndpoint(sourceEndpointUuid);
        var destinationElementId = "activity-" + workflowId + "-" + transitionModel.destinationActivityId;
        plumber.connect({
          source: sourceEndpoint,
          target: destinationElementId
        });
      }
    };

    this.updateCanvasHeight = function () {
      var $container = $(this.container); // Get the activity element with the highest Y coordinate.

      var $activityElements = $container.find(".activity");
      var currentElementTop = 0;
      var currentActivityHeight = 0;

      for (var _i = 0, _a = $activityElements.toArray(); _i < _a.length; _i++) {
        var activityElement = _a[_i];
        var $activityElement = $(activityElement);
        var top_1 = $activityElement.position().top;

        if (top_1 > currentElementTop) {
          currentElementTop = top_1;
          currentActivityHeight = $activityElement.height();
        }
      }

      var newCanvasHeight = currentElementTop + currentActivityHeight;
      var elementBottom = currentElementTop + currentActivityHeight;
      var stretchValue = 100;

      if (newCanvasHeight - elementBottom <= stretchValue) {
        newCanvasHeight += stretchValue;
      }

      $container.height(Math.max(this.minCanvasHeight, newCanvasHeight));
    };
  }

  return WorkflowCanvas;
}();
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
///<reference path='./workflow-canvas.ts' />
var __extends = this && this.__extends || function () {
  var _extendStatics = function extendStatics(d, b) {
    _extendStatics = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function (d, b) {
      d.__proto__ = b;
    } || function (d, b) {
      for (var p in b) {
        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];
      }
    };

    return _extendStatics(d, b);
  };

  return function (d, b) {
    if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");

    _extendStatics(d, b);

    function __() {
      this.constructor = d;
    }

    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}(); // TODO: Re-implement this using a MVVM approach.


var WorkflowEditor =
/** @class */
function (_super) {
  __extends(WorkflowEditor, _super);

  function WorkflowEditor(container, workflowType, deleteActivityPrompt, localId, loadLocalState) {
    var _this = _super.call(this, container, workflowType) || this;

    _this.container = container;
    _this.workflowType = workflowType;
    _this.deleteActivityPrompt = deleteActivityPrompt;
    _this.localId = localId;

    _this.getState = function () {
      var $allActivityElements = $(_this.container).find('.activity');
      var workflow = {
        id: _this.workflowType.id,
        activities: [],
        transitions: [],
        removedActivities: _this.workflowType.removedActivities
      }; // Collect activities.

      for (var i = 0; i < $allActivityElements.length; i++) {
        var $activityElement = $($allActivityElements[i]);
        var activityId = $activityElement.data('activity-id');
        var activityIsStart = $activityElement.data('activity-start');
        var activityIsEvent = $activityElement.data('activity-type') === 'Event';
        var activityPosition = $activityElement.position();

        var activity = _this.getActivity(activityId);

        workflow.activities.push({
          id: activityId,
          isStart: activityIsStart,
          isEvent: activityIsEvent,
          outcomes: activity.outcomes,
          x: activityPosition.left,
          y: activityPosition.top
        });
      } // Collect connections.


      var allConnections = _this.jsPlumbInstance.getConnections();

      for (var i = 0; i < allConnections.length; i++) {
        var connection = allConnections[i];
        var sourceEndpoint = connection.endpoints[0];
        var sourceOutcomeName = sourceEndpoint.getParameters().outcome.name;
        var sourceActivityId = $(connection.source).data('activity-id');
        var destinationActivityId = $(connection.target).data('activity-id');
        workflow.transitions.push({
          sourceActivityId: sourceActivityId,
          destinationActivityId: destinationActivityId,
          sourceOutcomeName: sourceOutcomeName
        });
      }

      return workflow;
    };

    _this.serialize = function () {
      var workflow = _this.getState();

      return JSON.stringify(workflow);
    };

    _this.saveLocalState = function () {
      sessionStorage[_this.localId] = _this.serialize();
    };

    _this.loadLocalState = function () {
      return JSON.parse(sessionStorage[_this.localId]);
    };

    var self = _this;
    jsPlumb.ready(function () {
      jsPlumb.importDefaults(_this.getDefaults());

      var plumber = _this.createJsPlumbInstance(); // Listen for new connections.


      plumber.bind('connection', function (connInfo, originalEvent) {
        var connection = connInfo.connection;
        var outcome = connection.getParameters().outcome;
        var label = connection.getOverlay('label');
        label.setLabel(outcome.displayName);
      });

      var activityElements = _this.getActivityElements();

      var areEqualOutcomes = function areEqualOutcomes(outcomes1, outcomes2) {
        if (outcomes1.length != outcomes2.length) {
          return false;
        }

        for (var i = 0; i < outcomes1.length; i++) {
          var outcome1 = outcomes1[i];
          var outcome2 = outcomes2[i];

          if (outcome1.name != outcome2.displayName || outcome1.displayName != outcome2.displayName) {
            return false;
          }
        }

        return true;
      }; // Suspend drawing and initialize.


      plumber.batch(function () {
        var serverworkflowType = _this.workflowType;
        var workflowId = _this.workflowType.id;

        if (loadLocalState) {
          var localState = _this.loadLocalState();

          if (localState) {
            _this.workflowType = localState;
          }
        }

        activityElements.each(function (index, activityElement) {
          var $activityElement = $(activityElement);
          var activityId = $activityElement.data('activity-id');
          var isDeleted = _this.workflowType.removedActivities.indexOf(activityId) > -1;

          if (isDeleted) {
            $activityElement.remove();
            return;
          }

          var activity = _this.getActivity(activityId);

          var serverActivity = _this.getActivity(activityId, serverworkflowType.activities); // Update the activity's visual state.


          if (loadLocalState) {
            if (activity == null) {
              // This is a newly added activity not yet added to local state.
              activity = serverActivity;

              _this.workflowType.activities.push(activity);

              activity.x = 50;
              activity.y = 50;
            } else {
              // The available outcomes might have changed when editing an activity,
              // so we need to check for that and update the client's activity outcomes if so.
              var sameOutcomes = areEqualOutcomes(activity.outcomes, serverActivity.outcomes);

              if (!sameOutcomes) {
                activity.outcomes = serverActivity.outcomes;
              }

              $activityElement.css({
                left: activity.x,
                top: activity.y
              }).toggleClass('activity-start', activity.isStart).data('activity-start', activity.isStart);
            }
          } // Make the activity draggable.


          plumber.draggable(activityElement, {
            grid: [10, 10],
            containment: true,
            start: function start(args) {
              _this.dragStart = {
                left: args.e.screenX,
                top: args.e.screenY
              };
            },
            stop: function stop(args) {
              _this.hasDragged = _this.dragStart.left != args.e.screenX || _this.dragStart.top != args.e.screenY;

              _this.updateCanvasHeight();
            }
          }); // Configure the activity as a target.

          plumber.makeTarget(activityElement, {
            dropOptions: {
              hoverClass: 'hover'
            },
            anchor: 'Continuous',
            endpoint: ['Blank', {
              radius: 8
            }]
          }); // Add source endpoints.

          for (var _i = 0, _a = activity.outcomes; _i < _a.length; _i++) {
            var outcome = _a[_i];

            var sourceEndpointOptions = _this.getSourceEndpointOptions(activity, outcome);

            plumber.addEndpoint(activityElement, {
              connectorOverlays: [['Label', {
                label: outcome.displayName,
                cssClass: 'connection-label'
              }]]
            }, sourceEndpointOptions);
          }
        }); // Connect activities.

        _this.updateConnections(plumber); // Re-query the activity elements.


        activityElements = _this.getActivityElements(); // Make all activity elements visible.

        activityElements.show();

        _this.updateCanvasHeight();
      }); // Initialize popovers.

      activityElements.popover({
        trigger: 'manual',
        html: true,
        content: function content() {
          var activityElement = $(this);
          var $content = activityElement.find('.activity-commands').clone().show();
          var startButton = $content.find('.activity-start-action');
          var isStart = activityElement.data('activity-start') === true;
          var activityId = activityElement.data('activity-id');
          startButton.attr('aria-pressed', activityElement.data('activity-start'));
          startButton.toggleClass('active', isStart);
          $content.on('click', '.activity-start-action', function (e) {
            e.preventDefault();
            var button = $(e.currentTarget);
            button.button('toggle');
            var isStart = button.is('.active');
            activityElement.data('activity-start', isStart);
            activityElement.toggleClass('activity-start', isStart);
          });
          $content.on('click', '.activity-delete-action', function (e) {
            e.preventDefault(); // TODO: The prompts are really annoying. Consider showing some sort of small message balloon somewhere to undo the action instead.
            //if (!confirm(self.deleteActivityPrompt)) {
            //    return;
            //}

            self.workflowType.removedActivities.push(activityId);
            plumber.remove(activityElement);
            activityElement.popover('dispose');
          });
          $content.on('click', '[data-persist-workflow]', function (e) {
            self.saveLocalState();
          });
          return $content.get(0);
        }
      });
      $(container).on('click', '.activity', function (e) {
        if (_this.hasDragged) {
          _this.hasDragged = false;
          return;
        } // if any other popovers are visible, hide them


        if (_this.isPopoverVisible) {
          activityElements.popover('hide');
        }

        var sender = $(e.currentTarget);
        sender.popover('show'); // handle clicking on the popover itself.

        $('.popover').off('click').on('click', function (e2) {
          e2.stopPropagation();
        });
        e.stopPropagation();
        _this.isPopoverVisible = true;
      });
      $(container).on('dblclick', '.activity', function (e) {
        var sender = $(e.currentTarget);
        var hasEditor = sender.data('activity-has-editor');

        if (hasEditor) {
          _this.saveLocalState();

          sender.find('.activity-edit-action').get(0).click();
        }
      }); // Hide all popovers when clicking anywhere but on an activity.

      $('body').on('click', function (e) {
        activityElements.popover('hide');
        _this.isPopoverVisible = false;
      }); // Save local changes if the event target has the 'data-persist-workflow' attribute.

      $('body').on('click', '[data-persist-workflow]', function (e) {
        _this.saveLocalState();
      });
      _this.jsPlumbInstance = plumber;
    });
    return _this;
  }

  return WorkflowEditor;
}(WorkflowCanvas);

$.fn.workflowEditor = function () {
  this.each(function (index, element) {
    var $element = $(element);
    var workflowType = $element.data('workflow-type');
    var deleteActivityPrompt = $element.data('workflow-delete-activity-prompt');
    var localId = $element.data('workflow-local-id');
    var loadLocalState = $element.data('workflow-load-local-state');
    workflowType.removedActivities = workflowType.removedActivities || [];
    $element.data('workflowEditor', new WorkflowEditor(element, workflowType, deleteActivityPrompt, localId, loadLocalState));
  });
  return this;
};

$(document).ready(function () {
  var workflowEditor = $('.workflow-canvas').workflowEditor().data('workflowEditor');
  $('#workflowEditorForm').on('submit', function (s, e) {
    var state = workflowEditor.serialize();
    $('#workflowStateInput').val(state);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXR5LXBpY2tlci50cyIsIndvcmtmbG93LXVybC1nZW5lcmF0b3IudHMiLCJ3b3JrZmxvdy1jYW52YXMudHMiLCJ3b3JrZmxvdy1lZGl0b3IudHMiLCJ3b3JrZmxvdy1lZGl0b3IuanMiXSwibmFtZXMiOlsiYXBwbHlGaWx0ZXIiLCJjYXRlZ29yeSIsInEiLCJ0eXBlIiwiJCIsImRhdGEiLCJhdHRyIiwic3Vic3RyIiwidmFsIiwiJGNhcmRzIiwic2hvdyIsImZpbHRlciIsImkiLCJlbCIsImhpZGUiLCJsZW5ndGgiLCJmaW5kIiwidGV4dCIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsImVhY2giLCJjYXRlZ29yeUxpc3RJdGVtIiwiYWN0aXZpdHlDb3VudCIsIm9uIiwiZSIsInRhcmdldCIsImV2ZW50IiwibW9kYWxFdmVudCIsImJ1dHRvbiIsInJlbGF0ZWRUYXJnZXQiLCJ0aXRsZSIsIm1vZGFsIiwiY2xpY2siLCJnZW5lcmF0ZVdvcmtmbG93VXJsIiwid29ya2Zsb3dUeXBlSWQiLCJhY3Rpdml0eUlkIiwidG9rZW5MaWZlU3BhbiIsImdlbmVyYXRlVXJsIiwiYW50aWZvcmdlcnlIZWFkZXJOYW1lIiwiYW50aWZvcmdlcnlUb2tlbiIsImhlYWRlcnMiLCJwb3N0IiwidXJsIiwiZG9uZSIsIldvcmtmbG93Q2FudmFzIiwiY29udGFpbmVyIiwid29ya2Zsb3dUeXBlIiwiX3RoaXMiLCJtaW5DYW52YXNIZWlnaHQiLCJnZXRBY3Rpdml0eUVsZW1lbnRzIiwiZ2V0RGVmYXVsdHMiLCJBbmNob3IiLCJEcmFnT3B0aW9ucyIsImN1cnNvciIsInpJbmRleCIsIkVuZHBvaW50U3R5bGVzIiwiZmlsbFN0eWxlIiwiRW5kcG9pbnRzIiwicmFkaXVzIiwiQ29ubmVjdGlvbk92ZXJsYXlzIiwid2lkdGgiLCJsb2NhdGlvbiIsIkNvbm5lY3RvclpJbmRleCIsImNyZWF0ZUpzUGx1bWJJbnN0YW5jZSIsImpzUGx1bWIiLCJnZXRJbnN0YW5jZSIsInZpc2libGUiLCJpZCIsImNzc0NsYXNzIiwiQ29udGFpbmVyIiwiZ2V0RW5kcG9pbnRDb2xvciIsImFjdGl2aXR5IiwiaXNCbG9ja2luZyIsImlzU3RhcnQiLCJpc0V2ZW50IiwiZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zIiwib3V0Y29tZSIsInBhaW50Q29sb3IiLCJlbmRwb2ludCIsImFuY2hvciIsInBhaW50U3R5bGUiLCJzdHJva2UiLCJmaWxsIiwic3Ryb2tlV2lkdGgiLCJpc1NvdXJjZSIsImNvbm5lY3RvciIsInN0dWIiLCJnYXAiLCJjb3JuZXJSYWRpdXMiLCJhbHdheXNSZXNwZWN0U3R1YnMiLCJjb25uZWN0b3JTdHlsZSIsImpvaW5zdHlsZSIsIm91dGxpbmVTdHJva2UiLCJvdXRsaW5lV2lkdGgiLCJob3ZlclBhaW50U3R5bGUiLCJjb25uZWN0b3JIb3ZlclN0eWxlIiwiY29ubmVjdG9yT3ZlcmxheXMiLCJkcmFnT3B0aW9ucyIsInV1aWQiLCJuYW1lIiwicGFyYW1ldGVycyIsImdldEFjdGl2aXR5IiwiYWN0aXZpdGllcyIsImdyZXAiLCJ4IiwidXBkYXRlQ29ubmVjdGlvbnMiLCJwbHVtYmVyIiwid29ya2Zsb3dJZCIsIl9pIiwiX2EiLCJ0cmFuc2l0aW9ucyIsInRyYW5zaXRpb25Nb2RlbCIsInNvdXJjZUVuZHBvaW50VXVpZCIsInNvdXJjZUFjdGl2aXR5SWQiLCJzb3VyY2VPdXRjb21lTmFtZSIsInNvdXJjZUVuZHBvaW50IiwiZ2V0RW5kcG9pbnQiLCJkZXN0aW5hdGlvbkVsZW1lbnRJZCIsImRlc3RpbmF0aW9uQWN0aXZpdHlJZCIsImNvbm5lY3QiLCJzb3VyY2UiLCJ1cGRhdGVDYW52YXNIZWlnaHQiLCIkY29udGFpbmVyIiwiJGFjdGl2aXR5RWxlbWVudHMiLCJjdXJyZW50RWxlbWVudFRvcCIsImN1cnJlbnRBY3Rpdml0eUhlaWdodCIsInRvQXJyYXkiLCJhY3Rpdml0eUVsZW1lbnQiLCIkYWN0aXZpdHlFbGVtZW50IiwidG9wXzEiLCJwb3NpdGlvbiIsInRvcCIsImhlaWdodCIsIm5ld0NhbnZhc0hlaWdodCIsImVsZW1lbnRCb3R0b20iLCJzdHJldGNoVmFsdWUiLCJNYXRoIiwibWF4IiwiX19leHRlbmRzIiwiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiV29ya2Zsb3dFZGl0b3IiLCJfc3VwZXIiLCJkZWxldGVBY3Rpdml0eVByb21wdCIsImxvY2FsSWQiLCJsb2FkTG9jYWxTdGF0ZSIsImdldFN0YXRlIiwiJGFsbEFjdGl2aXR5RWxlbWVudHMiLCJ3b3JrZmxvdyIsInJlbW92ZWRBY3Rpdml0aWVzIiwiYWN0aXZpdHlJc1N0YXJ0IiwiYWN0aXZpdHlJc0V2ZW50IiwiYWN0aXZpdHlQb3NpdGlvbiIsInB1c2giLCJvdXRjb21lcyIsImxlZnQiLCJ5IiwiYWxsQ29ubmVjdGlvbnMiLCJqc1BsdW1iSW5zdGFuY2UiLCJnZXRDb25uZWN0aW9ucyIsImNvbm5lY3Rpb24iLCJlbmRwb2ludHMiLCJnZXRQYXJhbWV0ZXJzIiwic2VyaWFsaXplIiwiSlNPTiIsInN0cmluZ2lmeSIsInNhdmVMb2NhbFN0YXRlIiwic2Vzc2lvblN0b3JhZ2UiLCJwYXJzZSIsInNlbGYiLCJyZWFkeSIsImltcG9ydERlZmF1bHRzIiwiYmluZCIsImNvbm5JbmZvIiwib3JpZ2luYWxFdmVudCIsImxhYmVsIiwiZ2V0T3ZlcmxheSIsInNldExhYmVsIiwiZGlzcGxheU5hbWUiLCJhY3Rpdml0eUVsZW1lbnRzIiwiYXJlRXF1YWxPdXRjb21lcyIsIm91dGNvbWVzMSIsIm91dGNvbWVzMiIsIm91dGNvbWUxIiwib3V0Y29tZTIiLCJiYXRjaCIsInNlcnZlcndvcmtmbG93VHlwZSIsImxvY2FsU3RhdGUiLCJpbmRleCIsImlzRGVsZXRlZCIsInJlbW92ZSIsInNlcnZlckFjdGl2aXR5Iiwic2FtZU91dGNvbWVzIiwiY3NzIiwidG9nZ2xlQ2xhc3MiLCJkcmFnZ2FibGUiLCJncmlkIiwiY29udGFpbm1lbnQiLCJzdGFydCIsImFyZ3MiLCJkcmFnU3RhcnQiLCJzY3JlZW5YIiwic2NyZWVuWSIsInN0b3AiLCJoYXNEcmFnZ2VkIiwibWFrZVRhcmdldCIsImRyb3BPcHRpb25zIiwiaG92ZXJDbGFzcyIsInNvdXJjZUVuZHBvaW50T3B0aW9ucyIsImFkZEVuZHBvaW50IiwicG9wb3ZlciIsInRyaWdnZXIiLCJodG1sIiwiY29udGVudCIsIiRjb250ZW50IiwiY2xvbmUiLCJzdGFydEJ1dHRvbiIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudFRhcmdldCIsImlzIiwiZ2V0IiwiaXNQb3BvdmVyVmlzaWJsZSIsInNlbmRlciIsIm9mZiIsImUyIiwic3RvcFByb3BhZ2F0aW9uIiwiaGFzRWRpdG9yIiwiZm4iLCJ3b3JrZmxvd0VkaXRvciIsImVsZW1lbnQiLCIkZWxlbWVudCIsImRvY3VtZW50IiwicyIsInN0YXRlIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBRUEsSUFBSUEsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBVUMsUUFBVixFQUE0QkMsQ0FBNUIsRUFBcUM7QUFDbkQsTUFBTUMsSUFBSSxHQUFHQyxDQUFDLENBQUMsbUJBQUQsQ0FBRCxDQUF1QkMsSUFBdkIsQ0FBNEIsZUFBNUIsQ0FBYjtBQUNBSixFQUFBQSxRQUFRLEdBQUdBLFFBQVEsSUFBSUcsQ0FBQyxDQUFDLDhDQUFELENBQUQsQ0FBa0RFLElBQWxELENBQXVELE1BQXZELEVBQStEQyxNQUEvRCxDQUFzRSxDQUF0RSxDQUF2QjtBQUNBTCxFQUFBQSxDQUFDLEdBQUdBLENBQUMsSUFBWUUsQ0FBQyxDQUFDLHNDQUFELENBQUQsQ0FBMENJLEdBQTFDLEVBQWpCO0FBRUEsTUFBTUMsTUFBTSxHQUFHTCxDQUFDLENBQUMsZ0JBQUQsQ0FBRCxDQUFvQk0sSUFBcEIsRUFBZixDQUxtRCxDQU9uRDs7QUFDQUQsRUFBQUEsTUFB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bUJBQWQsQ0FBdEI7QUFDQSxRQUFJMEosY0FBYyxHQUFZcUYsUUFBUSxDQUFDL08sSUFBVCxDQUFjLDJCQUFkLENBQTlCO0FBRUF5QyxJQUFBQSxZQUFZLENBQUNxSCxpQkFBYixHQUFpQ3JILFlBQVksQ0FBQ3FILGlCQUFiLElBQWtDLEVBQW5FO0FBQ0FpRixJQUFBQSxRQUFRLENBQUMvTyxJQUFULENBQWMsZ0JBQWQsRUFBZ0MsSUFBSXNKLGNBQUosQ0FBbUJ3RixPQUFuQixFQUE0QnJNLFlBQTVCLEVBQTBDK0csb0JBQTFDLEVBQWdFQyxPQUFoRSxFQUF5RUMsY0FBekUsQ0FBaEM7QUFDSCxHQVREO0FBV0EsU0FBTyxJQUFQO0FBQ0gsQ0FiRDs7QUFlQTNKLENBQUMsQ0FBQ2lQLFFBQUQsQ0FBRCxDQUFZN0QsS0FBWixDQUFrQixZQUFBO0FBQ2QsTUFBTTBELGNBQWMsR0FBbUI5TyxDQUFDLENBQUMsa0JBQUQsQ0FBRCxDQUFzQjhPLGNBQXRCLEdBQXVDN08sSUFBdkMsQ0FBNEMsZ0JBQTVDLENBQXZDO0FBRUFELEVBQUFBLENBQUMsQ0FBQyxxQkFBRCxDQUFELENBQXlCbUIsRUFBekIsQ0FBNEIsUUFBNUIsRUFBc0MsVUFBQytOLENBQUQsRUFBSTlOLENBQUosRUFBSztBQUN2QyxRQUFNK04sS0FBSyxHQUFHTCxjQUFjLENBQUNqRSxTQUFmLEVBQWQ7QUFDQTdLLElBQUFBLENBQUMsQ0FBQyxxQkFBRCxDQUFELENBQXlCSSxHQUF6QixDQUE2QitPLEtBQTdCO0FBQ0gsR0FIRDtBQUlILENBUEQiLCJmaWxlIjoib3JjaGFyZC53b3JrZmxvd3MtZWRpdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50cycgLz5cclxuXHJcbnZhciBhcHBseUZpbHRlciA9IGZ1bmN0aW9uIChjYXRlZ29yeTogc3RyaW5nLCBxOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHR5cGUgPSAkKCcubW9kYWwtYWN0aXZpdGllcycpLmRhdGEoJ2FjdGl2aXR5LXR5cGUnKTtcclxuICAgIGNhdGVnb3J5ID0gY2F0ZWdvcnkgfHwgJCgnLmFjdGl2aXR5LXBpY2tlci1jYXRlZ29yaWVzIC5uYXYtbGluay5hY3RpdmUnKS5hdHRyKCdocmVmJykuc3Vic3RyKDEpO1xyXG4gICAgcSA9IHEgfHwgPHN0cmluZz4kKCcubW9kYWwtYWN0aXZpdGllcyBpbnB1dFt0eXBlPXNlYXJjaF0nKS52YWwoKTtcclxuXHJcbiAgICBjb25zdCAkY2FyZHMgPSAkKCcuYWN0aXZpdHkuY2FyZCcpLnNob3coKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgYWN0aXZpdGllcyB3aG9lcyB0eXBlIGRvZXNuJ3QgbWF0Y2ggdGhlIGNvbmZpZ3VyZWQgYWN0aXZpdHkgdHlwZS5cclxuICAgICRjYXJkcy5maWx0ZXIoKGksIGVsKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQoZWwpLmRhdGEoJ2FjdGl2aXR5LXR5cGUnKSAhPSB0eXBlO1xyXG4gICAgfSkuaGlkZSgpO1xyXG5cclxuICAgIGlmIChxLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAvLyBSZW1vdmUgYWN0aXZpdGllcyB3aG9zZSB0aXRsZSBkb2Vzbid0IG1hdGNoIHRoZSBxdWVyeS5cclxuICAgICAgICAkY2FyZHMuZmlsdGVyKChpLCBlbCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gJChlbCkuZmluZCgnLmNhcmQtdGl0bGUnKS50ZXh0KCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHEudG9Mb3dlckNhc2UoKSkgPCAwICYmIHEgJiYgcS5sZW5ndGggPiAwO1xyXG4gICAgICAgIH0pLmhpZGUoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIFJlbW92ZSBhY3Rpdml0aWVzIHdob3NlIGNhdGVnb3J5IGRvZXNuJ3QgbWF0Y2ggdGhlIHNlbGVjdGVkIG9uZS5cclxuICAgICAgICAkY2FyZHMuZmlsdGVyKChpLCBlbCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gJChlbCkuZGF0YSgnY2F0ZWdvcnknKS50b0xvd2VyQ2FzZSgpICE9IGNhdGVnb3J5LnRvTG93ZXJDYXNlKCkgJiYgY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSAhPSAnYWxsJztcclxuICAgICAgICB9KS5oaWRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2hvdyBvciBoaWRlIGNhdGVnb3JpZXMgYmFzZWQgb24gd2hldGhlciB0aGVyZSBhcmUgYW55IGF2YWlsYWJsZSBhY3Rpdml0aWVzLlxyXG4gICAgJCgnLmFjdGl2aXR5LXBpY2tlci1jYXRlZ29yaWVzIFtkYXRhLWNhdGVnb3J5XScpLmVhY2goKGksIGVsKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlMaXN0SXRlbSA9ICQoZWwpO1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gY2F0ZWdvcnlMaXN0SXRlbS5kYXRhKCdjYXRlZ29yeScpO1xyXG5cclxuICAgICAgICAvLyBDb3VudCBudW1iZXIgb2YgYWN0aXZpdGllcyB3aXRoaW4gdGhpcyBjYXRlZ29yeSBhbmQgZm9yIHRoZSBzcGVjaWZpZWQgYWN0aXZpdHkgdHlwZSAoRXZlbnQgb3IgVGFzaykuXHJcbiAgICAgICAgY29uc3QgYWN0aXZpdHlDb3VudCA9ICQoYC5hY3Rpdml0eS5jYXJkW2RhdGEtY2F0ZWdvcnk9JyR7Y2F0ZWdvcnl9J11bZGF0YS1hY3Rpdml0eS10eXBlPScke3R5cGV9J11gKS5sZW5ndGg7XHJcbiAgICAgICAgYWN0aXZpdHlDb3VudCA9PSAwID8gY2F0ZWdvcnlMaXN0SXRlbS5oaWRlKCkgOiBjYXRlZ29yeUxpc3RJdGVtLnNob3coKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuJCgoKSA9PiB7XHJcbiAgICAkKCcuYWN0aXZpdHktcGlja2VyLWNhdGVnb3JpZXMnKS5vbignY2xpY2snLCAnLm5hdi1saW5rJywgZSA9PiB7XHJcbiAgICAgICAgYXBwbHlGaWx0ZXIoJChlLnRhcmdldCkuYXR0cignaHJlZicpLnN1YnN0cigxKSwgbnVsbCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcubW9kYWwtYWN0aXZpdGllcyBpbnB1dFt0eXBlPXNlYXJjaF0nKS5vbigna2V5dXAnLCBlID0+IHtcclxuICAgICAgICBhcHBseUZpbHRlcihudWxsLCA8c3RyaW5nPiQoZS50YXJnZXQpLnZhbCgpKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNhY3Rpdml0eS1waWNrZXInKS5vbignc2hvdy5icy5tb2RhbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciBtb2RhbEV2ZW50ID0gZXZlbnQgYXMgYW55O1xyXG4gICAgICAgIHZhciBidXR0b24gPSAkKG1vZGFsRXZlbnQucmVsYXRlZFRhcmdldCk7IC8vIEJ1dHRvbiB0aGF0IHRyaWdnZXJlZCB0aGUgbW9kYWwuXHJcbiAgICAgICAgdmFyIHRpdGxlID0gYnV0dG9uLmRhdGEoJ3BpY2tlci10aXRsZScpO1xyXG4gICAgICAgIHZhciB0eXBlID0gYnV0dG9uLmRhdGEoJ2FjdGl2aXR5LXR5cGUnKTtcclxuICAgICAgICB2YXIgbW9kYWwgPSAkKHRoaXMpO1xyXG4gICAgICAgIG1vZGFsLmZpbmQoJ1tocmVmPVwiI2FsbFwiXScpLmNsaWNrKCk7XHJcbiAgICAgICAgbW9kYWwuZmluZCgnLm1vZGFsLXRpdGxlJykudGV4dCh0aXRsZSk7XHJcbiAgICAgICAgbW9kYWwuZGF0YSgnYWN0aXZpdHktdHlwZScsIHR5cGUpO1xyXG4gICAgICAgIGFwcGx5RmlsdGVyKG51bGwsIG51bGwpO1xyXG4gICAgfSlcclxufSk7XHJcbiIsIi8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uLy4uL0Fzc2V0cy9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50c1wiIC8+XHJcblxyXG4kKCgpID0+IHtcclxuICAgIGNvbnN0IGdlbmVyYXRlV29ya2Zsb3dVcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3Qgd29ya2Zsb3dUeXBlSWQ6IHN0cmluZyA9ICQoJ1tkYXRhLXdvcmtmbG93LXR5cGUtaWRdJykuZGF0YSgnd29ya2Zsb3ctdHlwZS1pZCcpO1xyXG4gICAgICAgIGNvbnN0IGFjdGl2aXR5SWQ6IHN0cmluZyA9ICQoJ1tkYXRhLWFjdGl2aXR5LWlkXScpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcbiAgICAgICAgdmFyIHRva2VuTGlmZVNwYW4gPSAkKCcjdG9rZW4tbGlmZXNwYW4nKS52YWwoKTtcclxuICAgICAgICBjb25zdCBnZW5lcmF0ZVVybDogc3RyaW5nID0gJCgnW2RhdGEtZ2VuZXJhdGUtdXJsXScpLmRhdGEoJ2dlbmVyYXRlLXVybCcpICsgYD93b3JrZmxvd1R5cGVJZD0ke3dvcmtmbG93VHlwZUlkfSZhY3Rpdml0eUlkPSR7YWN0aXZpdHlJZH0mdG9rZW5MaWZlU3Bhbj0ke3Rva2VuTGlmZVNwYW59YDtcclxuICAgICAgICBjb25zdCBhbnRpZm9yZ2VyeUhlYWRlck5hbWU6IHN0cmluZyA9ICQoJ1tkYXRhLWFudGlmb3JnZXJ5LWhlYWRlci1uYW1lXScpLmRhdGEoJ2FudGlmb3JnZXJ5LWhlYWRlci1uYW1lJyk7XHJcbiAgICAgICAgY29uc3QgYW50aWZvcmdlcnlUb2tlbjogc3RyaW5nID0gJCgnW2RhdGEtYW50aWZvcmdlcnktdG9rZW5dJykuZGF0YSgnYW50aWZvcmdlcnktdG9rZW4nKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzOiBhbnkgPSB7fTtcclxuXHJcbiAgICAgICAgaGVhZGVyc1thbnRpZm9yZ2VyeUhlYWRlck5hbWVdID0gYW50aWZvcmdlcnlUb2tlbjtcclxuXHJcbiAgICAgICAgJC5wb3N0KHtcclxuICAgICAgICAgICAgdXJsOiBnZW5lcmF0ZVVybCxcclxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xyXG4gICAgICAgIH0pLmRvbmUodXJsID0+IHtcclxuICAgICAgICAgICAgJCgnI3dvcmtmbG93LXVybC10ZXh0JykudmFsKHVybCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQoJyNnZW5lcmF0ZS11cmwtYnV0dG9uJykub24oJ2NsaWNrJywgZSA9PiB7XHJcbiAgICAgICAgZ2VuZXJhdGVXb3JrZmxvd1VybCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCQoJyN3b3JrZmxvdy11cmwtdGV4dCcpLnZhbCgpID09ICcnKSB7XHJcbiAgICAgICAgZ2VuZXJhdGVXb3JrZmxvd1VybCgpO1xyXG4gICAgfVxyXG59KTtcclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50cycgLz5cclxuLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanNwbHVtYi90eXBpbmdzLmQudHMnIC8+XHJcbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi93b3JrZmxvdy1tb2RlbHMudHMnIC8+XHJcblxyXG5hYnN0cmFjdCBjbGFzcyBXb3JrZmxvd0NhbnZhcyB7XHJcbiAgICBwcml2YXRlIG1pbkNhbnZhc0hlaWdodDogbnVtYmVyID0gNDAwO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBjb250YWluZXI6IEhUTUxFbGVtZW50LCBwcm90ZWN0ZWQgd29ya2Zsb3dUeXBlOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlKSB7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGdldEFjdGl2aXR5RWxlbWVudHMgPSAoKTogSlF1ZXJ5ID0+IHtcclxuICAgICAgICByZXR1cm4gJCh0aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGdldERlZmF1bHRzID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIEFuY2hvcjogXCJDb250aW51b3VzXCIsXHJcbiAgICAgICAgICAgIERyYWdPcHRpb25zOiB7IGN1cnNvcjogJ3BvaW50ZXInLCB6SW5kZXg6IDIwMDAgfSxcclxuICAgICAgICAgICAgRW5kcG9pbnRTdHlsZXM6IFt7IGZpbGxTdHlsZTogJyMyMjU1ODgnIH1dLFxyXG4gICAgICAgICAgICBFbmRwb2ludHM6IFtbXCJEb3RcIiwgeyByYWRpdXM6IDcgfV0sIFtcIkJsYW5rXCJdXSxcclxuICAgICAgICAgICAgQ29ubmVjdGlvbk92ZXJsYXlzOiBbXHJcbiAgICAgICAgICAgICAgICBbXCJBcnJvd1wiLCB7IHdpZHRoOiAxMiwgbGVuZ3RoOiAxMiwgbG9jYXRpb246IC01IH1dLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBDb25uZWN0b3JaSW5kZXg6IDVcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHByb3RlY3RlZCBjcmVhdGVKc1BsdW1iSW5zdGFuY2UgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGpzUGx1bWIuZ2V0SW5zdGFuY2Uoe1xyXG4gICAgICAgICAgICBEcmFnT3B0aW9uczogeyBjdXJzb3I6ICdwb2ludGVyJywgekluZGV4OiAyMDAwIH0sXHJcbiAgICAgICAgICAgIENvbm5lY3Rpb25PdmVybGF5czogW1xyXG4gICAgICAgICAgICAgICAgWydBcnJvdycsIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogMSxcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMSxcclxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDExXHJcbiAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgIFsnTGFiZWwnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246IDAuNSxcclxuICAgICAgICAgICAgICAgICAgICBpZDogJ2xhYmVsJyxcclxuICAgICAgICAgICAgICAgICAgICBjc3NDbGFzczogJ2Nvbm5lY3Rpb24tbGFiZWwnXHJcbiAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBDb250YWluZXI6IHRoaXMuY29udGFpbmVyXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHByb3RlY3RlZCBnZXRFbmRwb2ludENvbG9yID0gKGFjdGl2aXR5OiBXb3JrZmxvd3MuQWN0aXZpdHkpID0+IHtcclxuICAgICAgICByZXR1cm4gYWN0aXZpdHkuaXNCbG9ja2luZyB8fCBhY3Rpdml0eS5pc1N0YXJ0ID8gJyM3YWIwMmMnIDogYWN0aXZpdHkuaXNFdmVudCA/ICcjM2E4YWNkJyA6ICcjN2FiMDJjJztcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zID0gKGFjdGl2aXR5OiBXb3JrZmxvd3MuQWN0aXZpdHksIG91dGNvbWU6IFdvcmtmbG93cy5PdXRjb21lKTogRW5kcG9pbnRPcHRpb25zID0+IHtcclxuICAgICAgICAvLyBUaGUgZGVmaW5pdGlvbiBvZiBzb3VyY2UgZW5kcG9pbnRzLlxyXG4gICAgICAgIGNvbnN0IHBhaW50Q29sb3IgPSB0aGlzLmdldEVuZHBvaW50Q29sb3IoYWN0aXZpdHkpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGVuZHBvaW50OiAnRG90JyxcclxuICAgICAgICAgICAgYW5jaG9yOiAnQ29udGludW91cycsXHJcbiAgICAgICAgICAgIHBhaW50U3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogcGFpbnRDb2xvcixcclxuICAgICAgICAgICAgICAgIGZpbGw6IHBhaW50Q29sb3IsXHJcbiAgICAgICAgICAgICAgICByYWRpdXM6IDcsXHJcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpc1NvdXJjZTogdHJ1ZSxcclxuICAgICAgICAgICAgY29ubmVjdG9yOiBbJ0Zsb3djaGFydCcsIHsgc3R1YjogWzQwLCA2MF0sIGdhcDogMCwgY29ybmVyUmFkaXVzOiA1LCBhbHdheXNSZXNwZWN0U3R1YnM6IHRydWUgfV0sXHJcbiAgICAgICAgICAgIGNvbm5lY3RvclN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMixcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogJyM5OTk5OTknLFxyXG4gICAgICAgICAgICAgICAgam9pbnN0eWxlOiAncm91bmQnLFxyXG4gICAgICAgICAgICAgICAgb3V0bGluZVN0cm9rZTogJ3doaXRlJyxcclxuICAgICAgICAgICAgICAgIG91dGxpbmVXaWR0aDogMlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBob3ZlclBhaW50U3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIGZpbGw6ICcjMjE2NDc3JyxcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogJyMyMTY0NzcnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbm5lY3RvckhvdmVyU3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAzLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiAnIzIxNjQ3NycsXHJcbiAgICAgICAgICAgICAgICBvdXRsaW5lV2lkdGg6IDUsXHJcbiAgICAgICAgICAgICAgICBvdXRsaW5lU3Ryb2tlOiAnd2hpdGUnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbm5lY3Rvck92ZXJsYXlzOiBbWydMYWJlbCcsIHsgbG9jYXRpb246IFszLCAtMS41XSwgY3NzQ2xhc3M6ICdlbmRwb2ludFNvdXJjZUxhYmVsJyB9XV0sXHJcbiAgICAgICAgICAgIGRyYWdPcHRpb25zOiB7fSxcclxuICAgICAgICAgICAgdXVpZDogYCR7YWN0aXZpdHkuaWR9LSR7b3V0Y29tZS5uYW1lfWAsXHJcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHtcclxuICAgICAgICAgICAgICAgIG91dGNvbWU6IG91dGNvbWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHByb3RlY3RlZCBnZXRBY3Rpdml0eSA9IGZ1bmN0aW9uIChpZDogc3RyaW5nLCBhY3Rpdml0aWVzOiBBcnJheTxXb3JrZmxvd3MuQWN0aXZpdHk+ID0gbnVsbCk6IFdvcmtmbG93cy5BY3Rpdml0eSB7XHJcbiAgICAgICAgaWYgKCFhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgIGFjdGl2aXRpZXMgPSB0aGlzLndvcmtmbG93VHlwZS5hY3Rpdml0aWVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJC5ncmVwKGFjdGl2aXRpZXMsICh4OiBXb3JrZmxvd3MuQWN0aXZpdHkpID0+IHguaWQgPT09IGlkKVswXTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgdXBkYXRlQ29ubmVjdGlvbnMgPSAocGx1bWJlcjoganNQbHVtYkluc3RhbmNlKSA9PiB7XHJcbiAgICAgICAgdmFyIHdvcmtmbG93SWQ6IG51bWJlciA9IHRoaXMud29ya2Zsb3dUeXBlLmlkO1xyXG5cclxuICAgICAgICAvLyBDb25uZWN0IGFjdGl2aXRpZXMuXHJcbiAgICAgICAgZm9yIChsZXQgdHJhbnNpdGlvbk1vZGVsIG9mIHRoaXMud29ya2Zsb3dUeXBlLnRyYW5zaXRpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZUVuZHBvaW50VXVpZDogc3RyaW5nID0gYCR7dHJhbnNpdGlvbk1vZGVsLnNvdXJjZUFjdGl2aXR5SWR9LSR7dHJhbnNpdGlvbk1vZGVsLnNvdXJjZU91dGNvbWVOYW1lfWA7XHJcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZUVuZHBvaW50OiBFbmRwb2ludCA9IHBsdW1iZXIuZ2V0RW5kcG9pbnQoc291cmNlRW5kcG9pbnRVdWlkKTtcclxuICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25FbGVtZW50SWQ6IHN0cmluZyA9IGBhY3Rpdml0eS0ke3dvcmtmbG93SWR9LSR7dHJhbnNpdGlvbk1vZGVsLmRlc3RpbmF0aW9uQWN0aXZpdHlJZH1gO1xyXG5cclxuICAgICAgICAgICAgcGx1bWJlci5jb25uZWN0KHtcclxuICAgICAgICAgICAgICAgIHNvdXJjZTogc291cmNlRW5kcG9pbnQsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGRlc3RpbmF0aW9uRWxlbWVudElkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgdXBkYXRlQ2FudmFzSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0ICRjb250YWluZXIgPSAkKHRoaXMuY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgLy8gR2V0IHRoZSBhY3Rpdml0eSBlbGVtZW50IHdpdGggdGhlIGhpZ2hlc3QgWSBjb29yZGluYXRlLlxyXG4gICAgICAgIGNvbnN0ICRhY3Rpdml0eUVsZW1lbnRzID0gJGNvbnRhaW5lci5maW5kKFwiLmFjdGl2aXR5XCIpO1xyXG4gICAgICAgIGxldCBjdXJyZW50RWxlbWVudFRvcCA9IDA7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRBY3Rpdml0eUhlaWdodCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGFjdGl2aXR5RWxlbWVudCBvZiAkYWN0aXZpdHlFbGVtZW50cy50b0FycmF5KCkpIHtcclxuICAgICAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudCA9ICQoYWN0aXZpdHlFbGVtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgdG9wID0gJGFjdGl2aXR5RWxlbWVudC5wb3NpdGlvbigpLnRvcDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0b3AgPiBjdXJyZW50RWxlbWVudFRvcCkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnRUb3AgPSB0b3A7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50QWN0aXZpdHlIZWlnaHQgPSAkYWN0aXZpdHlFbGVtZW50LmhlaWdodCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgbmV3Q2FudmFzSGVpZ2h0ID0gY3VycmVudEVsZW1lbnRUb3AgKyBjdXJyZW50QWN0aXZpdHlIZWlnaHQ7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudEJvdHRvbSA9IGN1cnJlbnRFbGVtZW50VG9wICsgY3VycmVudEFjdGl2aXR5SGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IHN0cmV0Y2hWYWx1ZSA9IDEwMDtcclxuXHJcbiAgICAgICAgaWYgKG5ld0NhbnZhc0hlaWdodCAtIGVsZW1lbnRCb3R0b20gPD0gc3RyZXRjaFZhbHVlKSB7XHJcbiAgICAgICAgICAgIG5ld0NhbnZhc0hlaWdodCArPSBzdHJldGNoVmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY29udGFpbmVyLmhlaWdodChNYXRoLm1heCh0aGlzLm1pbkNhbnZhc0hlaWdodCwgbmV3Q2FudmFzSGVpZ2h0KSk7XHJcbiAgICB9O1xyXG59XHJcbiIsIi8vLzxyZWZlcmVuY2UgcGF0aD0nLi4vTGliL2pxdWVyeS90eXBpbmdzLmQudHMnIC8+XHJcbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi4vTGliL2pzcGx1bWIvdHlwaW5ncy5kLnRzJyAvPlxyXG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctbW9kZWxzLnRzJyAvPlxyXG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctY2FudmFzLnRzJyAvPlxyXG5cclxuLy8gVE9ETzogUmUtaW1wbGVtZW50IHRoaXMgdXNpbmcgYSBNVlZNIGFwcHJvYWNoLlxyXG5jbGFzcyBXb3JrZmxvd0VkaXRvciBleHRlbmRzIFdvcmtmbG93Q2FudmFzIHtcclxuICAgIHByaXZhdGUganNQbHVtYkluc3RhbmNlOiBqc1BsdW1iSW5zdGFuY2U7XHJcbiAgICBwcml2YXRlIGlzUG9wb3ZlclZpc2libGU6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIGhhc0RyYWdnZWQ6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIGRyYWdTdGFydDogSlF1ZXJ5LkNvb3JkaW5hdGVzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBjb250YWluZXI6IEhUTUxFbGVtZW50LCBwcm90ZWN0ZWQgd29ya2Zsb3dUeXBlOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlLCBwcml2YXRlIGRlbGV0ZUFjdGl2aXR5UHJvbXB0OiBzdHJpbmcsIHByaXZhdGUgbG9jYWxJZDogc3RyaW5nLCBsb2FkTG9jYWxTdGF0ZTogYm9vbGVhbikge1xyXG4gICAgICAgIHN1cGVyKGNvbnRhaW5lciwgd29ya2Zsb3dUeXBlKTtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAganNQbHVtYi5yZWFkeSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGpzUGx1bWIuaW1wb3J0RGVmYXVsdHModGhpcy5nZXREZWZhdWx0cygpKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBsdW1iZXIgPSB0aGlzLmNyZWF0ZUpzUGx1bWJJbnN0YW5jZSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBuZXcgY29ubmVjdGlvbnMuXHJcbiAgICAgICAgICAgIHBsdW1iZXIuYmluZCgnY29ubmVjdGlvbicsIGZ1bmN0aW9uIChjb25uSW5mbywgb3JpZ2luYWxFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbjogQ29ubmVjdGlvbiA9IGNvbm5JbmZvLmNvbm5lY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRjb21lOiBXb3JrZmxvd3MuT3V0Y29tZSA9IGNvbm5lY3Rpb24uZ2V0UGFyYW1ldGVycygpLm91dGNvbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbGFiZWw6IGFueSA9IGNvbm5lY3Rpb24uZ2V0T3ZlcmxheSgnbGFiZWwnKTtcclxuICAgICAgICAgICAgICAgIGxhYmVsLnNldExhYmVsKG91dGNvbWUuZGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBhY3Rpdml0eUVsZW1lbnRzID0gdGhpcy5nZXRBY3Rpdml0eUVsZW1lbnRzKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgYXJlRXF1YWxPdXRjb21lcyA9IGZ1bmN0aW9uIChvdXRjb21lczE6IFdvcmtmbG93cy5PdXRjb21lW10sIG91dGNvbWVzMjogV29ya2Zsb3dzLk91dGNvbWVbXSk6IGJvb2xlYW4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG91dGNvbWVzMS5sZW5ndGggIT0gb3V0Y29tZXMyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG91dGNvbWVzMS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dGNvbWUxID0gb3V0Y29tZXMxW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dGNvbWUyID0gb3V0Y29tZXMyW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3V0Y29tZTEubmFtZSAhPSBvdXRjb21lMi5kaXNwbGF5TmFtZSB8fCBvdXRjb21lMS5kaXNwbGF5TmFtZSAhPSBvdXRjb21lMi5kaXNwbGF5TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTdXNwZW5kIGRyYXdpbmcgYW5kIGluaXRpYWxpemUuXHJcbiAgICAgICAgICAgIHBsdW1iZXIuYmF0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlcndvcmtmbG93VHlwZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9IHRoaXMud29ya2Zsb3dUeXBlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtmbG93SWQ6IG51bWJlciA9IHRoaXMud29ya2Zsb3dUeXBlLmlkO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChsb2FkTG9jYWxTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvY2FsU3RhdGU6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSB0aGlzLmxvYWRMb2NhbFN0YXRlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2NhbFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud29ya2Zsb3dUeXBlID0gbG9jYWxTdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5lYWNoKChpbmRleCwgYWN0aXZpdHlFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudCA9ICQoYWN0aXZpdHlFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlkID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRGVsZXRlZCA9IHRoaXMud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzLmluZGV4T2YoYWN0aXZpdHlJZCkgPiAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRGVsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYWN0aXZpdHlFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZpdHkgPSB0aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcnZlckFjdGl2aXR5ID0gdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkLCBzZXJ2ZXJ3b3JrZmxvd1R5cGUuYWN0aXZpdGllcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgYWN0aXZpdHkncyB2aXN1YWwgc3RhdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRMb2NhbFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbmV3bHkgYWRkZWQgYWN0aXZpdHkgbm90IHlldCBhZGRlZCB0byBsb2NhbCBzdGF0ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VydmVyQWN0aXZpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmtmbG93VHlwZS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnggPSA1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnkgPSA1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhdmFpbGFibGUgb3V0Y29tZXMgbWlnaHQgaGF2ZSBjaGFuZ2VkIHdoZW4gZWRpdGluZyBhbiBhY3Rpdml0eSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoYXQgYW5kIHVwZGF0ZSB0aGUgY2xpZW50J3MgYWN0aXZpdHkgb3V0Y29tZXMgaWYgc28uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzYW1lT3V0Y29tZXMgPSBhcmVFcXVhbE91dGNvbWVzKGFjdGl2aXR5Lm91dGNvbWVzLCBzZXJ2ZXJBY3Rpdml0eS5vdXRjb21lcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYW1lT3V0Y29tZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eS5vdXRjb21lcyA9IHNlcnZlckFjdGl2aXR5Lm91dGNvbWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpdml0eUVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKHsgbGVmdDogYWN0aXZpdHkueCwgdG9wOiBhY3Rpdml0eS55IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKCdhY3Rpdml0eS1zdGFydCcsIGFjdGl2aXR5LmlzU3RhcnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgYWN0aXZpdHkuaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIGFjdGl2aXR5IGRyYWdnYWJsZS5cclxuICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLmRyYWdnYWJsZShhY3Rpdml0eUVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZDogWzEwLCAxMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogKGFyZ3M6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnQgPSB7IGxlZnQ6IGFyZ3MuZS5zY3JlZW5YLCB0b3A6IGFyZ3MuZS5zY3JlZW5ZIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3A6IChhcmdzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzRHJhZ2dlZCA9IHRoaXMuZHJhZ1N0YXJ0LmxlZnQgIT0gYXJncy5lLnNjcmVlblggfHwgdGhpcy5kcmFnU3RhcnQudG9wICE9IGFyZ3MuZS5zY3JlZW5ZO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBDb25maWd1cmUgdGhlIGFjdGl2aXR5IGFzIGEgdGFyZ2V0LlxyXG4gICAgICAgICAgICAgICAgICAgIHBsdW1iZXIubWFrZVRhcmdldChhY3Rpdml0eUVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcE9wdGlvbnM6IHsgaG92ZXJDbGFzczogJ2hvdmVyJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6ICdDb250aW51b3VzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFsnQmxhbmsnLCB7IHJhZGl1czogOCB9XVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgc291cmNlIGVuZHBvaW50cy5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBvdXRjb21lIG9mIGFjdGl2aXR5Lm91dGNvbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZUVuZHBvaW50T3B0aW9ucyA9IHRoaXMuZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zKGFjdGl2aXR5LCBvdXRjb21lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5hZGRFbmRwb2ludChhY3Rpdml0eUVsZW1lbnQsIHsgY29ubmVjdG9yT3ZlcmxheXM6IFtbJ0xhYmVsJywgeyBsYWJlbDogb3V0Y29tZS5kaXNwbGF5TmFtZSwgY3NzQ2xhc3M6ICdjb25uZWN0aW9uLWxhYmVsJyB9XV0gfSwgc291cmNlRW5kcG9pbnRPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb25uZWN0IGFjdGl2aXRpZXMuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbm5lY3Rpb25zKHBsdW1iZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFJlLXF1ZXJ5IHRoZSBhY3Rpdml0eSBlbGVtZW50cy5cclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMgPSB0aGlzLmdldEFjdGl2aXR5RWxlbWVudHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGFsbCBhY3Rpdml0eSBlbGVtZW50cyB2aXNpYmxlLlxyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHBvcG92ZXJzLlxyXG4gICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLnBvcG92ZXIoe1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlcjogJ21hbnVhbCcsXHJcbiAgICAgICAgICAgICAgICBodG1sOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5RWxlbWVudCA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJGNvbnRlbnQ6IEpRdWVyeTxFbGVtZW50PiA9IGFjdGl2aXR5RWxlbWVudC5maW5kKCcuYWN0aXZpdHktY29tbWFuZHMnKS5jbG9uZSgpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydEJ1dHRvbiA9ICRjb250ZW50LmZpbmQoJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1N0YXJ0ID0gYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykgPT09IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlJZDogbnVtYmVyID0gYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0QnV0dG9uLmF0dHIoJ2FyaWEtcHJlc3NlZCcsIGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcpKTtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydEJ1dHRvbi50b2dnbGVDbGFzcygnYWN0aXZlJywgaXNTdGFydCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRjb250ZW50Lm9uKCdjbGljaycsICcuYWN0aXZpdHktc3RhcnQtYWN0aW9uJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbigndG9nZ2xlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1N0YXJ0ID0gYnV0dG9uLmlzKCcuYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcsIGlzU3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQudG9nZ2xlQ2xhc3MoJ2FjdGl2aXR5LXN0YXJ0JywgaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRjb250ZW50Lm9uKCdjbGljaycsICcuYWN0aXZpdHktZGVsZXRlLWFjdGlvbicsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaGUgcHJvbXB0cyBhcmUgcmVhbGx5IGFubm95aW5nLiBDb25zaWRlciBzaG93aW5nIHNvbWUgc29ydCBvZiBzbWFsbCBtZXNzYWdlIGJhbGxvb24gc29tZXdoZXJlIHRvIHVuZG8gdGhlIGFjdGlvbiBpbnN0ZWFkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmICghY29uZmlybShzZWxmLmRlbGV0ZUFjdGl2aXR5UHJvbXB0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi53b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMucHVzaChhY3Rpdml0eUlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5yZW1vdmUoYWN0aXZpdHlFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LnBvcG92ZXIoJ2Rpc3Bvc2UnKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJ1tkYXRhLXBlcnNpc3Qtd29ya2Zsb3ddJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZUxvY2FsU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRjb250ZW50LmdldCgwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2NsaWNrJywgJy5hY3Rpdml0eScsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzRHJhZ2dlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzRHJhZ2dlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhbnkgb3RoZXIgcG9wb3ZlcnMgYXJlIHZpc2libGUsIGhpZGUgdGhlbVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3BvdmVyVmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMucG9wb3ZlcignaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRlciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIHNlbmRlci5wb3BvdmVyKCdzaG93Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIGNsaWNraW5nIG9uIHRoZSBwb3BvdmVyIGl0c2VsZi5cclxuICAgICAgICAgICAgICAgICQoJy5wb3BvdmVyJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGUyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlMi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNQb3BvdmVyVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJChjb250YWluZXIpLm9uKCdkYmxjbGljaycsICcuYWN0aXZpdHknLCBlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRlciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhhc0VkaXRvciA9IHNlbmRlci5kYXRhKCdhY3Rpdml0eS1oYXMtZWRpdG9yJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0VkaXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUxvY2FsU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZW5kZXIuZmluZCgnLmFjdGl2aXR5LWVkaXQtYWN0aW9uJykuZ2V0KDApLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gSGlkZSBhbGwgcG9wb3ZlcnMgd2hlbiBjbGlja2luZyBhbnl3aGVyZSBidXQgb24gYW4gYWN0aXZpdHkuXHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCBlID0+IHtcclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMucG9wb3ZlcignaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BvcG92ZXJWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gU2F2ZSBsb2NhbCBjaGFuZ2VzIGlmIHRoZSBldmVudCB0YXJnZXQgaGFzIHRoZSAnZGF0YS1wZXJzaXN0LXdvcmtmbG93JyBhdHRyaWJ1dGUuXHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBlID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUxvY2FsU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmpzUGx1bWJJbnN0YW5jZSA9IHBsdW1iZXI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRTdGF0ZSA9ICgpOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0+IHtcclxuICAgICAgICBjb25zdCAkYWxsQWN0aXZpdHlFbGVtZW50cyA9ICQodGhpcy5jb250YWluZXIpLmZpbmQoJy5hY3Rpdml0eScpO1xyXG4gICAgICAgIGNvbnN0IHdvcmtmbG93OiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0ge1xyXG4gICAgICAgICAgICBpZDogdGhpcy53b3JrZmxvd1R5cGUuaWQsXHJcbiAgICAgICAgICAgIGFjdGl2aXRpZXM6IFtdLFxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uczogW10sXHJcbiAgICAgICAgICAgIHJlbW92ZWRBY3Rpdml0aWVzOiB0aGlzLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllc1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENvbGxlY3QgYWN0aXZpdGllcy5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICRhbGxBY3Rpdml0eUVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0ICRhY3Rpdml0eUVsZW1lbnQ6IEpRdWVyeSA9ICQoJGFsbEFjdGl2aXR5RWxlbWVudHNbaV0pO1xyXG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlkOiBzdHJpbmcgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5SXNTdGFydDogYm9vbGVhbiA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlJc0V2ZW50OiBib29sZWFuID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS10eXBlJykgPT09ICdFdmVudCc7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5UG9zaXRpb246IEpRdWVyeS5Db29yZGluYXRlcyA9ICRhY3Rpdml0eUVsZW1lbnQucG9zaXRpb24oKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHk6IFdvcmtmbG93cy5BY3Rpdml0eSA9IHRoaXMuZ2V0QWN0aXZpdHkoYWN0aXZpdHlJZCk7XHJcblxyXG4gICAgICAgICAgICB3b3JrZmxvdy5hY3Rpdml0aWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGFjdGl2aXR5SWQsXHJcbiAgICAgICAgICAgICAgICBpc1N0YXJ0OiBhY3Rpdml0eUlzU3RhcnQsXHJcbiAgICAgICAgICAgICAgICBpc0V2ZW50OiBhY3Rpdml0eUlzRXZlbnQsXHJcbiAgICAgICAgICAgICAgICBvdXRjb21lczogYWN0aXZpdHkub3V0Y29tZXMsXHJcbiAgICAgICAgICAgICAgICB4OiBhY3Rpdml0eVBvc2l0aW9uLmxlZnQsXHJcbiAgICAgICAgICAgICAgICB5OiBhY3Rpdml0eVBvc2l0aW9uLnRvcFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbGxlY3QgY29ubmVjdGlvbnMuXHJcbiAgICAgICAgY29uc3QgYWxsQ29ubmVjdGlvbnMgPSB0aGlzLmpzUGx1bWJJbnN0YW5jZS5nZXRDb25uZWN0aW9ucygpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbENvbm5lY3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjb25uZWN0aW9uID0gYWxsQ29ubmVjdGlvbnNbaV07XHJcbiAgICAgICAgICAgIHZhciBzb3VyY2VFbmRwb2ludDogRW5kcG9pbnQgPSBjb25uZWN0aW9uLmVuZHBvaW50c1swXTtcclxuICAgICAgICAgICAgdmFyIHNvdXJjZU91dGNvbWVOYW1lID0gc291cmNlRW5kcG9pbnQuZ2V0UGFyYW1ldGVycygpLm91dGNvbWUubmFtZTtcclxuICAgICAgICAgICAgdmFyIHNvdXJjZUFjdGl2aXR5SWQ6IHN0cmluZyA9ICQoY29ubmVjdGlvbi5zb3VyY2UpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcbiAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbkFjdGl2aXR5SWQ6IHN0cmluZyA9ICQoY29ubmVjdGlvbi50YXJnZXQpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcblxyXG4gICAgICAgICAgICB3b3JrZmxvdy50cmFuc2l0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHNvdXJjZUFjdGl2aXR5SWQ6IHNvdXJjZUFjdGl2aXR5SWQsXHJcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkFjdGl2aXR5SWQ6IGRlc3RpbmF0aW9uQWN0aXZpdHlJZCxcclxuICAgICAgICAgICAgICAgIHNvdXJjZU91dGNvbWVOYW1lOiBzb3VyY2VPdXRjb21lTmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB3b3JrZmxvdztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2VyaWFsaXplID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICAgICAgY29uc3Qgd29ya2Zsb3c6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSB0aGlzLmdldFN0YXRlKCk7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHdvcmtmbG93KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNhdmVMb2NhbFN0YXRlID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgIHNlc3Npb25TdG9yYWdlW3RoaXMubG9jYWxJZF0gPSB0aGlzLnNlcmlhbGl6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbG9hZExvY2FsU3RhdGUgPSAoKTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2VbdGhpcy5sb2NhbElkXSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiQuZm4ud29ya2Zsb3dFZGl0b3IgPSBmdW5jdGlvbiAodGhpczogSlF1ZXJ5KTogSlF1ZXJ5IHtcclxuICAgIHRoaXMuZWFjaCgoaW5kZXgsIGVsZW1lbnQpID0+IHtcclxuICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciB3b3JrZmxvd1R5cGU6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy10eXBlJyk7XHJcbiAgICAgICAgdmFyIGRlbGV0ZUFjdGl2aXR5UHJvbXB0OiBzdHJpbmcgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1kZWxldGUtYWN0aXZpdHktcHJvbXB0Jyk7XHJcbiAgICAgICAgdmFyIGxvY2FsSWQ6IHN0cmluZyA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LWxvY2FsLWlkJyk7XHJcbiAgICAgICAgdmFyIGxvYWRMb2NhbFN0YXRlOiBib29sZWFuID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9hZC1sb2NhbC1zdGF0ZScpO1xyXG5cclxuICAgICAgICB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgPSB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgfHwgW107XHJcbiAgICAgICAgJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3dFZGl0b3InLCBuZXcgV29ya2Zsb3dFZGl0b3IoZWxlbWVudCwgd29ya2Zsb3dUeXBlLCBkZWxldGVBY3Rpdml0eVByb21wdCwgbG9jYWxJZCwgbG9hZExvY2FsU3RhdGUpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3Qgd29ya2Zsb3dFZGl0b3I6IFdvcmtmbG93RWRpdG9yID0gJCgnLndvcmtmbG93LWNhbnZhcycpLndvcmtmbG93RWRpdG9yKCkuZGF0YSgnd29ya2Zsb3dFZGl0b3InKTtcclxuXHJcbiAgICAkKCcjd29ya2Zsb3dFZGl0b3JGb3JtJykub24oJ3N1Ym1pdCcsIChzLCBlKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB3b3JrZmxvd0VkaXRvci5zZXJpYWxpemUoKTtcclxuICAgICAgICAkKCcjd29ya2Zsb3dTdGF0ZUlucHV0JykudmFsKHN0YXRlKTtcclxuICAgIH0pO1xyXG59KTtcclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50cycgLz5cbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi4vTGliL2pzcGx1bWIvdHlwaW5ncy5kLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LW1vZGVscy50cycgLz5cbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi93b3JrZmxvdy1jYW52YXMudHMnIC8+XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuLy8gVE9ETzogUmUtaW1wbGVtZW50IHRoaXMgdXNpbmcgYSBNVlZNIGFwcHJvYWNoLlxudmFyIFdvcmtmbG93RWRpdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXb3JrZmxvd0VkaXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXb3JrZmxvd0VkaXRvcihjb250YWluZXIsIHdvcmtmbG93VHlwZSwgZGVsZXRlQWN0aXZpdHlQcm9tcHQsIGxvY2FsSWQsIGxvYWRMb2NhbFN0YXRlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGNvbnRhaW5lciwgd29ya2Zsb3dUeXBlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgICAgIF90aGlzLndvcmtmbG93VHlwZSA9IHdvcmtmbG93VHlwZTtcbiAgICAgICAgX3RoaXMuZGVsZXRlQWN0aXZpdHlQcm9tcHQgPSBkZWxldGVBY3Rpdml0eVByb21wdDtcbiAgICAgICAgX3RoaXMubG9jYWxJZCA9IGxvY2FsSWQ7XG4gICAgICAgIF90aGlzLmdldFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyICRhbGxBY3Rpdml0eUVsZW1lbnRzID0gJChfdGhpcy5jb250YWluZXIpLmZpbmQoJy5hY3Rpdml0eScpO1xuICAgICAgICAgICAgdmFyIHdvcmtmbG93ID0ge1xuICAgICAgICAgICAgICAgIGlkOiBfdGhpcy53b3JrZmxvd1R5cGUuaWQsXG4gICAgICAgICAgICAgICAgYWN0aXZpdGllczogW10sXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbnM6IFtdLFxuICAgICAgICAgICAgICAgIHJlbW92ZWRBY3Rpdml0aWVzOiBfdGhpcy53b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBDb2xsZWN0IGFjdGl2aXRpZXMuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRhbGxBY3Rpdml0eUVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyICRhY3Rpdml0eUVsZW1lbnQgPSAkKCRhbGxBY3Rpdml0eUVsZW1lbnRzW2ldKTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJZCA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJc1N0YXJ0ID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcpO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlzRXZlbnQgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXR5cGUnKSA9PT0gJ0V2ZW50JztcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlQb3NpdGlvbiA9ICRhY3Rpdml0eUVsZW1lbnQucG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHkgPSBfdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkKTtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdy5hY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYWN0aXZpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgaXNTdGFydDogYWN0aXZpdHlJc1N0YXJ0LFxuICAgICAgICAgICAgICAgICAgICBpc0V2ZW50OiBhY3Rpdml0eUlzRXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIG91dGNvbWVzOiBhY3Rpdml0eS5vdXRjb21lcyxcbiAgICAgICAgICAgICAgICAgICAgeDogYWN0aXZpdHlQb3NpdGlvbi5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICB5OiBhY3Rpdml0eVBvc2l0aW9uLnRvcFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ29sbGVjdCBjb25uZWN0aW9ucy5cbiAgICAgICAgICAgIHZhciBhbGxDb25uZWN0aW9ucyA9IF90aGlzLmpzUGx1bWJJbnN0YW5jZS5nZXRDb25uZWN0aW9ucygpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxDb25uZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjb25uZWN0aW9uID0gYWxsQ29ubmVjdGlvbnNbaV07XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZUVuZHBvaW50ID0gY29ubmVjdGlvbi5lbmRwb2ludHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZU91dGNvbWVOYW1lID0gc291cmNlRW5kcG9pbnQuZ2V0UGFyYW1ldGVycygpLm91dGNvbWUubmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlQWN0aXZpdHlJZCA9ICQoY29ubmVjdGlvbi5zb3VyY2UpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uQWN0aXZpdHlJZCA9ICQoY29ubmVjdGlvbi50YXJnZXQpLmRhdGEoJ2FjdGl2aXR5LWlkJyk7XG4gICAgICAgICAgICAgICAgd29ya2Zsb3cudHJhbnNpdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUFjdGl2aXR5SWQ6IHNvdXJjZUFjdGl2aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uQWN0aXZpdHlJZDogZGVzdGluYXRpb25BY3Rpdml0eUlkLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VPdXRjb21lTmFtZTogc291cmNlT3V0Y29tZU5hbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3b3JrZmxvdztcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2VyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHdvcmtmbG93ID0gX3RoaXMuZ2V0U3RhdGUoKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh3b3JrZmxvdyk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnNhdmVMb2NhbFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2VbX3RoaXMubG9jYWxJZF0gPSBfdGhpcy5zZXJpYWxpemUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMubG9hZExvY2FsU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZVtfdGhpcy5sb2NhbElkXSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzZWxmID0gX3RoaXM7XG4gICAgICAgIGpzUGx1bWIucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAganNQbHVtYi5pbXBvcnREZWZhdWx0cyhfdGhpcy5nZXREZWZhdWx0cygpKTtcbiAgICAgICAgICAgIHZhciBwbHVtYmVyID0gX3RoaXMuY3JlYXRlSnNQbHVtYkluc3RhbmNlKCk7XG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIG5ldyBjb25uZWN0aW9ucy5cbiAgICAgICAgICAgIHBsdW1iZXIuYmluZCgnY29ubmVjdGlvbicsIGZ1bmN0aW9uIChjb25uSW5mbywgb3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBjb25uZWN0aW9uID0gY29ubkluZm8uY29ubmVjdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgb3V0Y29tZSA9IGNvbm5lY3Rpb24uZ2V0UGFyYW1ldGVycygpLm91dGNvbWU7XG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gY29ubmVjdGlvbi5nZXRPdmVybGF5KCdsYWJlbCcpO1xuICAgICAgICAgICAgICAgIGxhYmVsLnNldExhYmVsKG91dGNvbWUuZGlzcGxheU5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgYWN0aXZpdHlFbGVtZW50cyA9IF90aGlzLmdldEFjdGl2aXR5RWxlbWVudHMoKTtcbiAgICAgICAgICAgIHZhciBhcmVFcXVhbE91dGNvbWVzID0gZnVuY3Rpb24gKG91dGNvbWVzMSwgb3V0Y29tZXMyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dGNvbWVzMS5sZW5ndGggIT0gb3V0Y29tZXMyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3V0Y29tZXMxLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRjb21lMSA9IG91dGNvbWVzMVtpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dGNvbWUyID0gb3V0Y29tZXMyW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3V0Y29tZTEubmFtZSAhPSBvdXRjb21lMi5kaXNwbGF5TmFtZSB8fCBvdXRjb21lMS5kaXNwbGF5TmFtZSAhPSBvdXRjb21lMi5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIFN1c3BlbmQgZHJhd2luZyBhbmQgaW5pdGlhbGl6ZS5cbiAgICAgICAgICAgIHBsdW1iZXIuYmF0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJ3b3JrZmxvd1R5cGUgPSBfdGhpcy53b3JrZmxvd1R5cGU7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmtmbG93SWQgPSBfdGhpcy53b3JrZmxvd1R5cGUuaWQ7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRMb2NhbFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFN0YXRlID0gX3RoaXMubG9hZExvY2FsU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLndvcmtmbG93VHlwZSA9IGxvY2FsU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYWN0aXZpdHlFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eUVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJZCA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRGVsZXRlZCA9IF90aGlzLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcy5pbmRleE9mKGFjdGl2aXR5SWQpID4gLTE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0RlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpdml0eUVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0gX3RoaXMuZ2V0QWN0aXZpdHkoYWN0aXZpdHlJZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJBY3Rpdml0eSA9IF90aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQsIHNlcnZlcndvcmtmbG93VHlwZS5hY3Rpdml0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBhY3Rpdml0eSdzIHZpc3VhbCBzdGF0ZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRMb2NhbFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBuZXdseSBhZGRlZCBhY3Rpdml0eSBub3QgeWV0IGFkZGVkIHRvIGxvY2FsIHN0YXRlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VydmVyQWN0aXZpdHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMud29ya2Zsb3dUeXBlLmFjdGl2aXRpZXMucHVzaChhY3Rpdml0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkueCA9IDUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5LnkgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhdmFpbGFibGUgb3V0Y29tZXMgbWlnaHQgaGF2ZSBjaGFuZ2VkIHdoZW4gZWRpdGluZyBhbiBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciB0aGF0IGFuZCB1cGRhdGUgdGhlIGNsaWVudCdzIGFjdGl2aXR5IG91dGNvbWVzIGlmIHNvLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzYW1lT3V0Y29tZXMgPSBhcmVFcXVhbE91dGNvbWVzKGFjdGl2aXR5Lm91dGNvbWVzLCBzZXJ2ZXJBY3Rpdml0eS5vdXRjb21lcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYW1lT3V0Y29tZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkub3V0Y29tZXMgPSBzZXJ2ZXJBY3Rpdml0eS5vdXRjb21lcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGl2aXR5RWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKHsgbGVmdDogYWN0aXZpdHkueCwgdG9wOiBhY3Rpdml0eS55IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50b2dnbGVDbGFzcygnYWN0aXZpdHktc3RhcnQnLCBhY3Rpdml0eS5pc1N0YXJ0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGF0YSgnYWN0aXZpdHktc3RhcnQnLCBhY3Rpdml0eS5pc1N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIHRoZSBhY3Rpdml0eSBkcmFnZ2FibGUuXG4gICAgICAgICAgICAgICAgICAgIHBsdW1iZXIuZHJhZ2dhYmxlKGFjdGl2aXR5RWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZDogWzEwLCAxMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWlubWVudDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRyYWdTdGFydCA9IHsgbGVmdDogYXJncy5lLnNjcmVlblgsIHRvcDogYXJncy5lLnNjcmVlblkgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhc0RyYWdnZWQgPSBfdGhpcy5kcmFnU3RhcnQubGVmdCAhPSBhcmdzLmUuc2NyZWVuWCB8fCBfdGhpcy5kcmFnU3RhcnQudG9wICE9IGFyZ3MuZS5zY3JlZW5ZO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ29uZmlndXJlIHRoZSBhY3Rpdml0eSBhcyBhIHRhcmdldC5cbiAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5tYWtlVGFyZ2V0KGFjdGl2aXR5RWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcE9wdGlvbnM6IHsgaG92ZXJDbGFzczogJ2hvdmVyJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiAnQ29udGludW91cycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogWydCbGFuaycsIHsgcmFkaXVzOiA4IH1dXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgc291cmNlIGVuZHBvaW50cy5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGFjdGl2aXR5Lm91dGNvbWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG91dGNvbWUgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlRW5kcG9pbnRPcHRpb25zID0gX3RoaXMuZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zKGFjdGl2aXR5LCBvdXRjb21lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdW1iZXIuYWRkRW5kcG9pbnQoYWN0aXZpdHlFbGVtZW50LCB7IGNvbm5lY3Rvck92ZXJsYXlzOiBbWydMYWJlbCcsIHsgbGFiZWw6IG91dGNvbWUuZGlzcGxheU5hbWUsIGNzc0NsYXNzOiAnY29ubmVjdGlvbi1sYWJlbCcgfV1dIH0sIHNvdXJjZUVuZHBvaW50T3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBDb25uZWN0IGFjdGl2aXRpZXMuXG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlQ29ubmVjdGlvbnMocGx1bWJlcik7XG4gICAgICAgICAgICAgICAgLy8gUmUtcXVlcnkgdGhlIGFjdGl2aXR5IGVsZW1lbnRzLlxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMgPSBfdGhpcy5nZXRBY3Rpdml0eUVsZW1lbnRzKCk7XG4gICAgICAgICAgICAgICAgLy8gTWFrZSBhbGwgYWN0aXZpdHkgZWxlbWVudHMgdmlzaWJsZS5cbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLnNob3coKTtcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBwb3BvdmVycy5cbiAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMucG9wb3Zlcih7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcjogJ21hbnVhbCcsXG4gICAgICAgICAgICAgICAgaHRtbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUVsZW1lbnQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGNvbnRlbnQgPSBhY3Rpdml0eUVsZW1lbnQuZmluZCgnLmFjdGl2aXR5LWNvbW1hbmRzJykuY2xvbmUoKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydEJ1dHRvbiA9ICRjb250ZW50LmZpbmQoJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzU3RhcnQgPSBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnKSA9PT0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5SWQgPSBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRCdXR0b24uYXR0cignYXJpYS1wcmVzc2VkJywgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykpO1xuICAgICAgICAgICAgICAgICAgICBzdGFydEJ1dHRvbi50b2dnbGVDbGFzcygnYWN0aXZlJywgaXNTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICRjb250ZW50Lm9uKCdjbGljaycsICcuYWN0aXZpdHktc3RhcnQtYWN0aW9uJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uKCd0b2dnbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1N0YXJ0ID0gYnV0dG9uLmlzKCcuYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnLCBpc1N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZpdHktc3RhcnQnLCBpc1N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICRjb250ZW50Lm9uKCdjbGljaycsICcuYWN0aXZpdHktZGVsZXRlLWFjdGlvbicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaGUgcHJvbXB0cyBhcmUgcmVhbGx5IGFubm95aW5nLiBDb25zaWRlciBzaG93aW5nIHNvbWUgc29ydCBvZiBzbWFsbCBtZXNzYWdlIGJhbGxvb24gc29tZXdoZXJlIHRvIHVuZG8gdGhlIGFjdGlvbiBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiAoIWNvbmZpcm0oc2VsZi5kZWxldGVBY3Rpdml0eVByb21wdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi53b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMucHVzaChhY3Rpdml0eUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdW1iZXIucmVtb3ZlKGFjdGl2aXR5RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQucG9wb3ZlcignZGlzcG9zZScpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJ1tkYXRhLXBlcnNpc3Qtd29ya2Zsb3ddJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZUxvY2FsU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkY29udGVudC5nZXQoMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2NsaWNrJywgJy5hY3Rpdml0eScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmhhc0RyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGFzRHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGlmIGFueSBvdGhlciBwb3BvdmVycyBhcmUgdmlzaWJsZSwgaGlkZSB0aGVtXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzUG9wb3ZlclZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZW5kZXIgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgc2VuZGVyLnBvcG92ZXIoJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgY2xpY2tpbmcgb24gdGhlIHBvcG92ZXIgaXRzZWxmLlxuICAgICAgICAgICAgICAgICQoJy5wb3BvdmVyJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlMikge1xuICAgICAgICAgICAgICAgICAgICBlMi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIF90aGlzLmlzUG9wb3ZlclZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2RibGNsaWNrJywgJy5hY3Rpdml0eScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbmRlciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaGFzRWRpdG9yID0gc2VuZGVyLmRhdGEoJ2FjdGl2aXR5LWhhcy1lZGl0b3InKTtcbiAgICAgICAgICAgICAgICBpZiAoaGFzRWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNhdmVMb2NhbFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRlci5maW5kKCcuYWN0aXZpdHktZWRpdC1hY3Rpb24nKS5nZXQoMCkuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEhpZGUgYWxsIHBvcG92ZXJzIHdoZW4gY2xpY2tpbmcgYW55d2hlcmUgYnV0IG9uIGFuIGFjdGl2aXR5LlxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNQb3BvdmVyVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBTYXZlIGxvY2FsIGNoYW5nZXMgaWYgdGhlIGV2ZW50IHRhcmdldCBoYXMgdGhlICdkYXRhLXBlcnNpc3Qtd29ya2Zsb3cnIGF0dHJpYnV0ZS5cbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnNhdmVMb2NhbFN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLmpzUGx1bWJJbnN0YW5jZSA9IHBsdW1iZXI7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBXb3JrZmxvd0VkaXRvcjtcbn0oV29ya2Zsb3dDYW52YXMpKTtcbiQuZm4ud29ya2Zsb3dFZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICB2YXIgd29ya2Zsb3dUeXBlID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctdHlwZScpO1xuICAgICAgICB2YXIgZGVsZXRlQWN0aXZpdHlQcm9tcHQgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1kZWxldGUtYWN0aXZpdHktcHJvbXB0Jyk7XG4gICAgICAgIHZhciBsb2NhbElkID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9jYWwtaWQnKTtcbiAgICAgICAgdmFyIGxvYWRMb2NhbFN0YXRlID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9hZC1sb2NhbC1zdGF0ZScpO1xuICAgICAgICB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgPSB3b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMgfHwgW107XG4gICAgICAgICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93RWRpdG9yJywgbmV3IFdvcmtmbG93RWRpdG9yKGVsZW1lbnQsIHdvcmtmbG93VHlwZSwgZGVsZXRlQWN0aXZpdHlQcm9tcHQsIGxvY2FsSWQsIGxvYWRMb2NhbFN0YXRlKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgIHZhciB3b3JrZmxvd0VkaXRvciA9ICQoJy53b3JrZmxvdy1jYW52YXMnKS53b3JrZmxvd0VkaXRvcigpLmRhdGEoJ3dvcmtmbG93RWRpdG9yJyk7XG4gICAgJCgnI3dvcmtmbG93RWRpdG9yRm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbiAocywgZSkge1xuICAgICAgICB2YXIgc3RhdGUgPSB3b3JrZmxvd0VkaXRvci5zZXJpYWxpemUoKTtcbiAgICAgICAgJCgnI3dvcmtmbG93U3RhdGVJbnB1dCcpLnZhbChzdGF0ZSk7XG4gICAgfSk7XG59KTtcbiJdfQ==
